[
    {
        "name": "TalkPiknoGuard",
        "trigger": "on_talk",
        "level_nid": "6B",
        "condition": "unit2.nid == 'Pikno' or unit2.nid == 'Guard'",
        "commands": [
            [
                "if",
                [
                    "game.check_alive('Pikno')"
                ]
            ],
            [
                "multi_add_portrait",
                [
                    "SoldierPurple",
                    "FarRight",
                    "Pikno",
                    "MidRight",
                    "Sages",
                    "Left"
                ]
            ],
            [
                "else",
                []
            ],
            [
                "multi_add_portrait",
                [
                    "SoldierPurple",
                    "Right",
                    "Sages",
                    "Left"
                ]
            ],
            [
                "end",
                []
            ],
            [
                "if",
                [
                    "game.check_alive('Pikno')"
                ]
            ],
            [
                "speak",
                [
                    "Pikno",
                    "Good day, Lord Sages."
                ]
            ],
            [
                "end",
                []
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "Welcome back, Lord Sages."
                ]
            ],
            [
                "speak",
                [
                    "Sages",
                    "Thank you both, someone in the holding cell?"
                ]
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "Some foolish mercenary."
                ]
            ],
            [
                "speak",
                [
                    "Sages",
                    "What did he do?"
                ]
            ],
            [
                "if",
                [
                    "game.check_alive('Pikno')"
                ]
            ],
            [
                "speak",
                [
                    "Pikno",
                    "Public nuisance, attempted robbery."
                ]
            ],
            [
                "else",
                []
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "Distrubing the peace, attempted robbery."
                ]
            ],
            [
                "end",
                []
            ],
            [
                "speak",
                [
                    "Sages",
                    "Huh..."
                ]
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "He's a troublemaker alright.|Claims we're \"obsessed with him\", and that we're \"haters\"."
                ]
            ],
            [
                "speak",
                [
                    "Sages",
                    "Sounds like a fun person to me!"
                ]
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "Uh, no, he isn't."
                ]
            ],
            [
                "speak",
                [
                    "Sages",
                    "Hang on, I want to see him!"
                ]
            ],
            [
                "if",
                [
                    "game.check_alive('Pikno')"
                ]
            ],
            [
                "speak",
                [
                    "Pikno",
                    "I advise against this, Lord Sages."
                ]
            ],
            [
                "else",
                []
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "I must protest, Milord."
                ]
            ],
            [
                "end",
                []
            ],
            [
                "speak",
                [
                    "Sages",
                    "This is an order!"
                ]
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "Alright..."
                ]
            ],
            [
                "multi_remove_portrait",
                [
                    "SoldierPurple",
                    "Pikno",
                    "Sages"
                ]
            ],
            [
                "show_layer",
                [
                    "door"
                ]
            ],
            [
                "sound",
                [
                    "Unlock"
                ]
            ],
            [
                "music",
                [
                    "Strange People"
                ]
            ],
            [
                "if",
                [
                    "game.check_alive('Pikno')"
                ]
            ],
            [
                "multi_add_portrait",
                [
                    "SoldierPurple",
                    "FarRight",
                    "Pikno",
                    "MidRight",
                    "Boey",
                    "FarLeft"
                ]
            ],
            [
                "add_portrait",
                [
                    "Sages",
                    "80,Bottom"
                ]
            ],
            [
                "else",
                []
            ],
            [
                "multi_add_portrait",
                [
                    "SoldierPurple",
                    "FarRight",
                    "Sages",
                    "MidRight",
                    "Boey",
                    "Left"
                ]
            ],
            [
                "end",
                []
            ],
            [
                "speak",
                [
                    "Boey",
                    "Girl! I told you I didn't do anything!|It's not my fault!"
                ]
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "Quiet! The prince wishes to speak to you."
                ]
            ],
            [
                "speak",
                [
                    "Boey",
                    "Prince? Nah! I'm outta here!"
                ]
            ],
            [
                "move_portrait",
                [
                    "Boey",
                    "OffscreenRight",
                    "FLAG(no_block)"
                ]
            ],
            [
                "move_unit",
                [
                    "Boey",
                    "9,13",
                    "normal",
                    "giveup",
                    "FLAG(no_follow)"
                ]
            ],
            [
                "if",
                [
                    "game.check_alive('Pikno')"
                ]
            ],
            [
                "speak",
                [
                    "Pikno",
                    "Great. We gotta chase him now."
                ]
            ],
            [
                "else",
                []
            ],
            [
                "speak",
                [
                    "SoldierPurple",
                    "After him!"
                ]
            ],
            [
                "end",
                []
            ],
            [
                "speak",
                [
                    "Sages",
                    "It's alright guys, I'll do it!"
                ]
            ],
            [
                "multi_remove_portrait",
                [
                    "SoldierPurple",
                    "Pikno",
                    "Sages",
                    "Boey"
                ]
            ],
            [
                "change_roam_ai",
                [
                    "Boey",
                    "BoeyEscape"
                ]
            ],
            [
                "add_talk",
                [
                    "Sages",
                    "Boey"
                ]
            ],
            [
                "remove_talk",
                [
                    "Sages",
                    "Guard"
                ]
            ],
            [
                "remove_talk",
                [
                    "Sages",
                    "Pikno"
                ]
            ],
            [
                "music_fade_back",
                []
            ]
        ],
        "only_once": false,
        "priority": 20,
        "source": "if;game.check_alive('Pikno')\n    multi_add_portrait;SoldierPurple;FarRight;Pikno;MidRight;Sages;Left\nelse\n    multi_add_portrait;SoldierPurple;Right;Sages;Left\nend\nif;game.check_alive('Pikno')\n    speak;Pikno;Good day, Lord Sages.\nend\nspeak;SoldierPurple;Welcome back, Lord Sages.\nspeak;Sages;Thank you both, someone in the holding cell?\nspeak;SoldierPurple;Some foolish mercenary.\nspeak;Sages;What did he do?\nif;game.check_alive('Pikno')\n    speak;Pikno;Public nuisance, attempted robbery.\nelse\n    speak;SoldierPurple;Distrubing the peace, attempted robbery.\nend\nspeak;Sages;Huh...\nspeak;SoldierPurple;He's a troublemaker alright.|Claims we're \"obsessed with him\", and that we're \"haters\".\nspeak;Sages;Sounds like a fun person to me!\nspeak;SoldierPurple;Uh, no, he isn't.\nspeak;Sages;Hang on, I want to see him!\nif;game.check_alive('Pikno')\n    speak;Pikno;I advise against this, Lord Sages.\nelse\n    speak;SoldierPurple;I must protest, Milord.\nend\nspeak;Sages;This is an order!\nspeak;SoldierPurple;Alright...\nmulti_remove_portrait;SoldierPurple;Pikno;Sages\nshow_layer;door\nsound;Unlock\nmusic;Strange People\nif;game.check_alive('Pikno')\n    multi_add_portrait;SoldierPurple;FarRight;Pikno;MidRight;Boey;FarLeft\n    add_portrait;Sages;80,Bottom;\nelse\n    multi_add_portrait;SoldierPurple;FarRight;Sages;MidRight;Boey;Left\nend\nspeak;Boey;Girl! I told you I didn't do anything!|It's not my fault!\nspeak;SoldierPurple;Quiet! The prince wishes to speak to you.\nspeak;Boey;Prince? Nah! I'm outta here!\nmove_portrait;Boey;OffscreenRight;FLAG(no_block)\nmove_unit;Boey;9,13;normal;giveup;FLAG(no_follow)\nif;game.check_alive('Pikno')\n    speak;Pikno;Great. We gotta chase him now.\nelse\n    speak;SoldierPurple;After him!\nend\nspeak;Sages;It's alright guys, I'll do it!\nmulti_remove_portrait;SoldierPurple;Pikno;Sages;Boey\nchange_roam_ai;Boey;BoeyEscape\nadd_talk;Sages;Boey\nremove_talk;Sages;Guard\nremove_talk;Sages;Pikno\nmusic_fade_back\n"
    }
]
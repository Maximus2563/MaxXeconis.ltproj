[
    {
        "name": "Arena",
        "trigger": "Arena",
        "level_nid": "21",
        "condition": "region.nid == 'Arena'",
        "commands": [],
        "only_once": false,
        "priority": 20,
        "_source": [
            "transition;close",
            "change_background;ArenaOutside",
            "draw_overlay_sprite;ArenaPortrait;arena_portrait;4,4;1",
            "table;GoldDisplay;[game.get_money()];;;60;right;funds_display;;center;FLAG(expression)",
            "add_unit;Vic;{unit};immediate;closest",
            "t;open",
            "if;unit.get_weapon()",
            "    choice;ArenaChoice;Would you like to wager 500 gold?;Yes,No;;horizontal",
            "    if;game.game_vars['ArenaChoice'] == 'Yes' and game.get_money() > 499",
            "        sound;GoldExchange",
            "        give_money;-500;no_banner",
            "        speak;;Good luck. Don't get yourself killed.;60,8;160;clear;;;;menu_bg_clear",
            "        t;close",
            "        wait;100",
            "        change_music;player_battle;44 Condemnation",
            "        interact_unit;{unit};Vic;;;20;arena;force_animation",
            "        music_fade_back",
            "        if;game.check_dead('Vic')",
            "            t;open",
            "            s;;So you won, eh? Here's your prize. 1000 gold.;60,8;160;clear;;;;menu_bg_clear",
            "            sound;GoldExchange",
            "            give_money;1000",
            "            wait;200",
            "            level_var;ArenaWin;True;",
            "            change_music;player_battle;Dark Wastes",
            "        end",
            "        has_attacked;{unit}",
            "    else",
            "        s;;What are you wasting my time for?;60,8;160;clear;;;;menu_bg_clear",
            "    end",
            "else",
            "    s;;What! You don't have a weapon! Get out of here!;60,8;160;clear;;;;menu_bg_clear",
            "end",
            "t;close",
            "remove_unit;Vic;immediate",
            "change_background",
            "rmtable;GoldDisplay",
            "remove_overlay_sprite;Dialogue",
            "remove_overlay_sprite;ArenaPortrait",
            "t;open",
            "if;'{v:ArenaWin}' == 'True'",
            "resurrect;Vic",
            "change_team;Vic;player",
            "add_unit;Vic;15,1;fade;closest;fade",
            "music;Guest of Shade",
            "add_portrait;Vic;Left",
            "speak;Vic;I haven't had my blood rushing like that... in a while!|I'm tagging along with you, if you don't mind.|Arena pitfighting was getting boring anyway.|The name's Vic, ex-sailor.|Set me on a foe, new Cap'n!",
            "remove_portrait;Vic",
            "music_fade_back",
            "reset;Vic",
            "remove_region;Arena",
            "end"
        ]
    }
]